app.controller('commitsController',
  function ($scope, $sce, $resource) {
    var commits = $resource('/commits/:repositoryName/:jiraCode');

    $scope.repositories = [
      '<%= (ENV['TARGET_REPOSITORIES'] || '').gsub(',', "','") %>'
    ];
    $scope.repositoryName = $scope.repositories[0];

    $scope.showCommits = function () {
      $scope.commits = [];

      commits.get({
        jiraCode: $scope.jiraCode, repositoryName: $scope.repositoryName
      }).$promise.then(function (response) {
        response.commits.forEach(function (commit) {
          $scope.commits.push(commit);
        });
      });
    };
  }
);
